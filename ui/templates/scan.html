<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scan {{.ID}} - sai</title>
    <link rel="stylesheet" href="/static/style.css">
    {{if or (eq .Status "pending") (eq .Status "in_progress")}}
    <meta http-equiv="refresh" content="2">
    {{end}}
</head>
<body>
    <div class="container">
        <h1><a href="/">sai</a></h1>
        
        <section class="scan-details">
            <h2>Scan #{{.ID}}</h2>
            
            <dl>
                <dt>Status</dt>
                <dd class="status-{{.Status}}">{{.Status}}</dd>
                
                {{if .Request.Path}}
                <dt>Path</dt>
                <dd>{{.Request.Path}}</dd>
                {{end}}
                
                {{if .Request.ZipFile}}
                <dt>Zip File</dt>
                <dd>{{.Request.ZipFile}}</dd>
                {{end}}
                
                <dt>Created</dt>
                <dd>{{.Request.CreatedAt.Format "2006-01-02 15:04:05"}}</dd>
                
                {{if not .StartedAt.IsZero}}
                <dt>Started</dt>
                <dd>{{.StartedAt.Format "2006-01-02 15:04:05"}}</dd>
                {{end}}
                
                {{if not .EndedAt.IsZero}}
                <dt>Ended</dt>
                <dd>{{.EndedAt.Format "2006-01-02 15:04:05"}}</dd>
                {{end}}
            </dl>

            {{if eq .Status "in_progress"}}
            <div class="progress">
                <div class="progress-bar" style="width: {{.ProgressPercent}}%"></div>
                <span>{{.Progress}} / {{.Total}} classes</span>
            </div>
            {{end}}

            {{if .Errors}}
            <details class="errors" {{if not .Classes}}open{{end}}>
                <summary>Errors ({{len .Errors}})</summary>
                <ul>
                    {{range .Errors}}
                    <li>{{.}}</li>
                    {{end}}
                </ul>
            </details>
            {{else if .Error}}
            <div class="error">{{.Error}}</div>
            {{end}}

            {{if .Classes}}
            <h3>Classes ({{len .Classes}})</h3>
            <ul class="class-list">
                {{range .Classes}}
                <li><a href="/c/{{.Name}}">{{.Name}}</a></li>
                {{end}}
            </ul>
            {{end}}
        </section>
    </div>
</body>
</html>
